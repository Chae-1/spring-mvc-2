쿠키, 세션
==

## 쿠키

HTTP는 기본적으로 비연결성 프로토콜이기때문에, 로그인을 유지하기 위해선 브라우저에 해당 정보를 보관하고 요청마다 서버에 데이터를 보내야한다.

사용자를 식별하고, 세션을 유지하기 위해 쿠키를 사용한다.

쿠키는 만료 날짜에 따라 세션, 영속 쿠기로 구분한다.
- 영속 쿠키: 만료 날짜를 입력하면 해당 날짜까지 유지
- 세션 쿠키: 브라우저 종료시 만료되는 쿠키
  - 별도로 시간을 지정하지 않으면 세션 쿠키.

하지만, 쿠키는 클라이언트에서 조작할 수 있기 때문에, 중요한 정보를 담아서는 안되고 항상 도메인에 관련없는 값을 제공해야한다.
- ex) uuid 같은 예측 불가능한 값

이렇기 때문에 UUID 같은 값을 쿠키에 담아 전달하고, 서버에 해당 중요 정보를 보관하는 방식인 세션이 등장한다.


## 세션
쿠키의 보안적 문제를 해결하기 위해 서버에 중요 정보를 보관하고 연결을 유지하는 방식을 `세션`이라고 한다.

로그인 과정에서 세션 동작 방식
1. ID, password를 서버에 전송한다.
2. 서버는 DB에서 해당 회원이 존재하는지 확인한다.
3. 있다면, 클라이언트를 식별할 수 있는 유일 값을 쿠키로 전달하고 그 값을 키값으로 중요 정보를 서버에 저장한다.


## 서블릿 HTTP 세션 
세션을 직접 구현하지 않고, 서블릿은 `HttpSession`이라는 기능을 제공한다.

세션을 생성하기 위해, `HttpServletRequest`의 `getSession` 메서드를 활용하면 된다.
- `public HttpSession getSession(boolean create)'
  - create 값이 default는 true이며, 기존 세션 있으면 기존 세션을 반환하고, 기존 세션이 없으면 새로 생성한다.
  - false라면, 기존에 생성된 세션이 없다면 null 값을 반환한다.

`HttpSession`을 사용하면, 편리하게 사용자 정보를 보관할 수 있다.
- 내부적으로는 세션 ID를 UUID 형태로 클라이언트에 쿠키로 전송하여 상태를 유지한다.
- 세션은 다음과 같은 정보를 제공한다.
  - `sessionId`: JSESSION의 값 : -> 세션을 생성할 때, 클라이언트로 전달하는 쿠키
  - `maxInactiveInterval`: 세션의 유효 시간을 지정할 수 있다.
  - `creationTime`: 세션 생성 일시
  - `lastAccessedTime`: 마지막 세션 접근 일자

세션은 `lastAccessedTime`을 기준으로 `maxInactiveInterval` 시간이 지나면, 세션을 제거한다.

